---
title: "Project 3"
resource_files:
- .Renviron
output:
  html_notebook:
    code_folding: hide
    toc: yes
    toc_depth: 4
    toc_float: yes
runtime: shiny
---


```{r setup, include=FALSE}
library(tidyverse)
library(data.world)
library(shiny)
knitr::opts_chunk$set(echo = TRUE)
```

## **Github Link** 
[Team 3 github](https://github.com/omar-olivarez/F17eDVProject3)

## **Introduction** 

The following analyses will observe trends in internet usage across the United State while also taking advantage of US Census Data.

## **Description of the dataset:** 
This data describes Internet Usage and Connectivity across the United States from July 2015 to October 2016. The columns that we used were a combination of the census population data,income data, internet usage and connectivity data.

[Original Dataset](http://www.governing.com/gov-data/internet-usage-by-state.html)

```{r}
project <- "https://data.world/kassandra-perez/internet-usage"
data.world::set_config(cfg_env("DW_API"))
df <- data.world::query(data.world::qry_sql("SELECT * FROM cleanedinternetusagebystate"), dataset = project)
abbr = data.world::query(data.world::qry_sql("SELECT * FROM stateabbr"), dataset = project)

states = df %>% dplyr::distinct(state)
under20k = df %>% dplyr::filter(percapitaincome < 20000) %>% dplyr::left_join(abbr, by = c("state" = "statename"))
```

## Internet Usage within different states

[Insight](https://data.world/kassandra-perez/f-17-edv-project-3/insights?anchor=https%3A%2F%2Fmedia.data.world%2Fy1DGViqGQDOAP3D6sAFm_image.png&id=7408d8f8-1973-45c5-b62a-06bc68370c1d&source=sb)

```{r}
renderPlot({
  ggplot(df) + geom_col(mapping = aes(x = state , y = internetusage)) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) 
})

```

```{r}

inputPanel(
  selectInput("selectState", label = "State:",
              choices = states, multiple=FALSE, selected="Texas")
)

renderPlot({
  df %>% dplyr::filter(state == input$selectState) %>%ggplot() + geom_col(mapping = aes(x = state, y = internetusage,fill=internetusagelevel))
})

```

## Scatter plot of internet usage at home against internet usage at work

```{r}

renderPlot({
  ggplot(df) + geom_point(mapping = aes (x=internetusageathome,y=internetusageatwork))
})

```

## Scatter plot: Per capita income vs internet penetration
This graph lets us see the relationship between per capita income and internet penetration.
```{r}
renderPlot({
  ggplot(df) + geom_point(aes(x = internet_penetration, y = percapitaincome))
})
```

We see that there is a positive relationship between income and internet penetration. Basically it tells us that the higher per capita income there is there will most likely be higher internet usage proportionate to the population. 

Link to Tableau: https://data.world/kassandra-perez/f-17-edv-project-3/insights/fbd97c5c-5583-4497-b3c3-3e9a440b2e35

## Boxplot 

[Insight](https://data.world/kassandra-perez/f-17-edv-project-3/insights/bdeb1f07-8337-42cc-985f-8724ac538efc)

```{r}
renderPlot({
  ggplot(df,mapping = aes(x = internetusageatworklevel,y = percapitaincome)) +
    geom_boxplot() 
})

```

<<<<<<< HEAD
This boxplot lets see the difference between internet usage depending on per capita income.
```{r}
renderPlot({
  ggplot(df) + geom_boxplot(aes(x = internetusageatworklevel, y = percapitaincome))
})
```

As we can see there is a gap in the data between low and medium levels of internet usage overall. We see that most of the data falls in the high level of internet usage which makes sense as higher capita income allows for more access to the internet, where ever it may be.

Link to tableau: https://data.world/kassandra-perez/f-17-edv-project-3/insights/bdeb1f07-8337-42cc-985f-8724ac538efc

## Barchart 
This first graph lets us see connections elsewhere aside from the home from a few poor states (<20000K per capita income).

```{r}
renderPlot({
  ggplot(under20k) + 
    geom_col(aes(x = abbr, y = nohomeconnection_connectelsewhere, color = internetusagelevel))
})
```

As we can see Alabama, Montana, Mississippi, New Mexico have the higher connections elsewhere aside from the home. Also from these four states, we see that Montana has a medium level of internet usage overall while the others have low level usage.

Link to tableau graph: https://data.world/kassandra-perez/f-17-edv-project-3/insights/9ef4ee09-2c9e-42b1-a7c9-cd663d5b0e8b

=======

## Facebook Users
[Insight](https://data.world/kassandra-perez/f-17-edv-project-3/insights?anchor=https%3A%2F%2Fmedia.data.world%2FvB011VwSQWe3P8wAjGvs_FB%2520Penetration.png&id=cd9940c0-de7e-4c62-886b-3cc94612fb9f&source=sb)

```{r}
renderPlot({
  ggplot(df) + geom_col(mapping = aes(x = state,y = facebook_users_august_2010, fill = internetusagelevel)) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) 
})

```

```{r}

inputPanel(
  selectInput("n_breaks", label = "Number of bins:",
              choices = c(10, 20, 35, 50, 100), selected = 20)
)

renderPlot({
  ggplot(df, mapping = aes(x = facebook_penetration,fill = youngcategories)) + geom_histogram(bins=input$n_breaks)
})

```

```{r}
renderPlot({
  ggplot(df) + 
    geom_col(mapping = aes(x = youngcategories, y = facebook_users_august_2010, fill = youngcategories)) +
    facet_grid(.~internetusagelevel)
})

```
>>>>>>> 9e28cfc445c39774bc5b5eb3be4c6883a739f590
